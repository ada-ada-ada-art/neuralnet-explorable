var radius=10,neuraSketches=[],NeuraSketch=function(e){var t={sketchDOMId:"",turnRateSelector:"",shouldRunInfinitely:!1,infiniteCallback:{func:null,params:[]},stopText:"Return Neura"};for(var n in e)t[n]=e[n];this.thisSketch=function(e){e.sketchId=$("#"+t.sketchDOMId).data("sketchId"),e.inputRot=1.5,e.leftRot=2,e.rightRot=2,e.myRot=0,e.rotStep=.01,e.beginPos,e.dogPos,e.rad=radius,e.stepVec,e.m=.2,e.b=15,e.line1Pos,e.line2Pos,e.timeOnPath=0,e.timeMax=0,e.pathDist=0,e.pathDistMax,e.shouldRun=!1,e.myPoints=[],e.myPointTimer=0,e.myPointTimerLength=50,e.setup=function(){e.createCanvas(640,240),e.angleMode(e.DEGREES),e.fill(255),e.stroke(51),e.strokeWeight(2),e.beginPos=e.getPathVector(e.rad/2),e.dogPos=e.createVector(e.beginPos.x,e.beginPos.y),e.stepVec=e.createVector(2,0),e.line1Pos=e.getPathVector(0),e.line2Pos=e.getPathVector(e.width)},e.draw=function(){t.turnRateSelector&&(e.inputRot=parseFloat($(t.turnRateSelector).val())),e.background("#fff"),e.line(e.line1Pos.x,e.line1Pos.y,e.line2Pos.x,e.line2Pos.y),e.rightRot=e.inputRot,e.leftRot=-1*e.inputRot,e.shouldRun&&(e.dogPos.x<e.width+e.rad/2?(e.hit=e.collideLineCircle(e.line1Pos.x,e.line1Pos.y,e.line2Pos.x,e.line2Pos.y,e.dogPos.x,e.dogPos.y,e.rad),e.dogPos.add(e.stepVec),e.onWhatSideOfLine=e.isAboveLine(e.line1Pos,e.line2Pos,e.dogPos),e.hit||1!==e.onWhatSideOfLine?e.hit||-1!==e.onWhatSideOfLine?e.timeOnPath++:e.myRot>e.leftRot&&(e.myRot=e.lerp(e.myRot,e.leftRot,e.rotStep)):e.myRot<e.rightRot&&(e.myRot=e.lerp(e.myRot,e.rightRot,e.rotStep)),e.pathDist+=Math.abs(e.dogPos.y-e.getPathVector(e.dogPos.x).y),e.dogPos.rotate(e.myRot)):(e.toggleSimulation(!1),e.resetSketch(),t.shouldRunInfinitely&&(console.log(e.pathDist+" | "+e.pathDistMax),e.pathDist,e.pathDistMax,t.infiniteCallback&&t.infiniteCallback.params&&t.infiniteCallback.func.apply(t.infiniteCallback,t.infiniteCallback.params),e.toggleSimulation(!0))),e.myPointTimer+e.myPointTimerLength<e.millis()&&(e.myPoints.length>500&&e.myPoints.shift(),e.myPoints.push(e.createVector(e.dogPos.x,e.dogPos.y)),e.myPointTimer=e.millis())),e.noFill(),e.stroke(51,100);for(let t=0;t<e.myPoints.length;t++)e.point(e.myPoints[t].x,e.myPoints[t].y);e.fill(255),e.stroke(51),e.ellipse(e.dogPos.x,e.dogPos.y,e.rad,e.rad),e.tempPos=p5.Vector.add(e.dogPos,e.stepVec),e.tempPos.rotate(e.myRot),e.direction=p5.Vector.sub(e.tempPos,e.dogPos),e.direction.normalize(),e.line(e.dogPos.x+e.direction.x*(.5*e.rad),e.dogPos.y+e.direction.y*(.5*e.rad),e.dogPos.x+e.direction.x*(1*e.rad),e.dogPos.y+e.direction.y*(1*e.rad)),e.updateScore()},e.getPathVector=function(t){var n=e.m*t+e.b,i=e.map(n,e.height,0,0,e.height);return e.createVector(t,i)},e.toggleSimulation=function(n){var i=$("#"+t.sketchDOMId).siblings(".play-sketch");e.shouldRun=void 0!==n?n:!e.shouldRun,e.shouldRun?(e.myPointTimer=e.millis(),e.pathDist=0,i.text(t.stopText)):(e.resetSketch(),e.checkHighScore(),i.text("Release Neura"))},e.isAboveLine=function(t,n,i){var o=e.createVector(n.x-t.x,n.y-t.y),a=e.createVector(i.x-t.x,i.y-t.y),s=o.x*a.y-o.y*a.x;return s>0?-1:s<0?1:0},e.resetSketch=function(){e.dogPos.x=e.beginPos.x,e.dogPos.y=e.beginPos.y,e.myRot=0},e.updateScore=function(){$("#"+t.sketchDOMId).siblings(".all-score-container").find(".score-container span").text(e.pathDist.toFixed(2))},e.checkHighScore=function(){var n=$("#"+t.sketchDOMId).siblings(".all-score-container");(e.pathDist<e.pathDistMax||void 0===e.pathDistMax)&&(e.pathDistMax=e.pathDist,n.find(".highscore-container span").text(e.pathDist.toFixed(2)))}},this.thisP5=new p5(this.thisSketch,t.sketchDOMId)};neuraSketches.push(new NeuraSketch({sketchDOMId:"intro-sketch-holder"})),neuraSketches.push(new NeuraSketch({sketchDOMId:"first-sketch-holder",turnRateSelector:".page-1 .sketch-holder-range"})),neuraSketches.push(new NeuraSketch({sketchDOMId:"second-sketch-holder",turnRateSelector:".page-2 input.angle",shouldRunInfinitely:!0,infiniteCallback:{func:randomizeTurningAngle,params:[".page-2 input.angle"]},stopText:"Stop Neura"})),neuraSketches.push(new NeuraSketch({sketchDOMId:"third-sketch-holder",turnRateSelector:".page-3 input.angle",shouldRunInfinitely:!0,infiniteCallback:{func:randomizeTurningAngle,params:[".page-3 input.angle",".page-3 .sketch-holder-range"]},stopText:"Stop Neura"})),neuraSketches.push(new NeuraSketch({sketchDOMId:"fourth-sketch-holder",turnRateSelector:".page-4 input.angle",shouldRunInfinitely:!0,infiniteCallback:{func:randomizeTurningAngle,params:[".page-4 input.angle",".page-4 .sketch-holder-range"]},stopText:"Stop Neura"}));var currentPage=0;function updateDOM(){$('input[type="range"]').each(function(e){$(this).siblings("span").text($(this).val())})}function randomizeTurningAngle(...e){if(e){var t=e[0],n=.01;e[1]&&(n=parseFloat($(e[1]).val())),n||(n=.01);var i=parseFloat($(t).val()),o=Math.random();o>.5?i+=n:o<=.5&&(i-=n),$(t).val(i.toFixed(4))}else console.error("No arguments given to randomizeTurningAngle")}$(document).ready(function(){$(".next-button").click(function(e){e.preventDefault(),$(".page-"+currentPage).removeClass("active"),neuraSketches[currentPage].thisP5.toggleSimulation(!1),currentPage++,$(".page-"+currentPage).addClass("active")}),$(".previous-button").click(function(e){e.preventDefault(),$(".page-"+currentPage).removeClass("active"),neuraSketches[currentPage].thisP5.toggleSimulation(!1),currentPage--,$(".page-"+currentPage).addClass("active")}),$(".play-sketch").click(function(e){e.preventDefault();var t=$(this).siblings(".sketch-container").data("sketch-id");neuraSketches[t].thisP5.toggleSimulation()}),$('input[type="range"]').change(function(e){var t=$(this).siblings(".sketch-container").data("sketch-id");neuraSketches[t].thisP5.toggleSimulation(!1)}),setInterval(updateDOM,50)});